{"ast":null,"code":"import axios from \"axios\";\nimport { servicePath, tokenPrefix } from \"../../constants/defaultValues\";\nimport errorMessage from \"../../constants/errorMessages\";\nimport { LOAD_USER, LOAD_USER_SUCCESS, LOGIN_USER, LOGIN_USER_SUCCESS, LOGOUT_USER, REGISTER_USER, REGISTER_USER_SUCCESS, LOGIN_USER_ERROR, REGISTER_USER_ERROR, FORGOT_PASSWORD, FORGOT_PASSWORD_SUCCESS, FORGOT_PASSWORD_ERROR, RESET_PASSWORD, RESET_PASSWORD_SUCCESS, RESET_PASSWORD_ERROR } from '../actions';\nexport var loadUser = function loadUser(user, history) {\n  return function (dispatch, getState) {\n    dispatch({\n      type: LOGIN_USER,\n      payload: {\n        user,\n        history\n      }\n    });\n    axios.get(servicePath + \"/auth/user\", {\n      headers: {\n        'X-API-TOKEN': tokenPrefix + getState().token\n      }\n    }).then(function (response) {\n      if (response.status === 200 && response.data['message'] === \"\") {\n        var data = response.data['data'];\n        dispatch({\n          type: LOGIN_USER_SUCCESS,\n          payload: {\n            token: data['api_token'],\n            user: data['user']\n          }\n        });\n        history.push('/');\n      } else {\n        var errorCode = response.data['message'];\n        dispatch({\n          type: LOGIN_USER_ERROR,\n          payload: errorMessage[errorCode]\n        });\n      }\n    }).catch(function (error) {\n      dispatch({\n        type: LOGIN_USER_ERROR,\n        payload: error\n      });\n    });\n  };\n};\nexport var loginUser = function loginUser(user, history) {\n  return function (dispatch) {\n    dispatch({\n      type: LOGIN_USER,\n      payload: {\n        user,\n        history\n      }\n    });\n    axios.post(servicePath + \"/auth/login\", {\n      email: user.email,\n      password: user.password\n    }).then(function (response) {\n      if (response.status === 200 && response.data['message'] === \"\") {\n        var data = response.data['data'];\n        localStorage.setItem('_fs_utk', data['api_token']);\n        dispatch({\n          type: LOGIN_USER_SUCCESS,\n          payload: {\n            token: data['api_token'],\n            user: data['user']\n          }\n        });\n        history.push('/');\n      } else {\n        var errorCode = response.data['message'];\n        dispatch({\n          type: LOGIN_USER_ERROR,\n          payload: errorMessage[errorCode]\n        });\n      }\n    }).catch(function (error) {\n      dispatch({\n        type: LOGIN_USER_ERROR,\n        payload: error\n      });\n    });\n  };\n};\nexport var forgotPassword = function forgotPassword(forgotUserMail, history) {\n  return {\n    type: FORGOT_PASSWORD,\n    payload: {\n      forgotUserMail,\n      history\n    }\n  };\n};\nexport var forgotPasswordSuccess = function forgotPasswordSuccess(forgotUserMail) {\n  return {\n    type: FORGOT_PASSWORD_SUCCESS,\n    payload: forgotUserMail\n  };\n};\nexport var forgotPasswordError = function forgotPasswordError(message) {\n  return {\n    type: FORGOT_PASSWORD_ERROR,\n    payload: {\n      message\n    }\n  };\n};\nexport var resetPassword = function resetPassword(_ref) {\n  var resetPasswordCode = _ref.resetPasswordCode,\n      newPassword = _ref.newPassword,\n      history = _ref.history;\n  return {\n    type: RESET_PASSWORD,\n    payload: {\n      resetPasswordCode,\n      newPassword,\n      history\n    }\n  };\n};\nexport var resetPasswordSuccess = function resetPasswordSuccess(newPassword) {\n  return {\n    type: RESET_PASSWORD_SUCCESS,\n    payload: newPassword\n  };\n};\nexport var resetPasswordError = function resetPasswordError(message) {\n  return {\n    type: RESET_PASSWORD_ERROR,\n    payload: {\n      message\n    }\n  };\n};\nexport var registerUser = function registerUser(user, history) {\n  return {\n    type: REGISTER_USER,\n    payload: {\n      user,\n      history\n    }\n  };\n};\nexport var registerUserSuccess = function registerUserSuccess(user) {\n  return {\n    type: REGISTER_USER_SUCCESS,\n    payload: user\n  };\n};\nexport var registerUserError = function registerUserError(message) {\n  return {\n    type: REGISTER_USER_ERROR,\n    payload: {\n      message\n    }\n  };\n};\nexport var logoutUser = function logoutUser(history) {\n  return function (displatch) {\n    localStorage.removeItem('_fs_utk');\n    displatch({\n      type: LOGOUT_USER\n    });\n  };\n};","map":{"version":3,"sources":["/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/src/redux/auth/actions.js"],"names":["axios","servicePath","tokenPrefix","errorMessage","LOAD_USER","LOAD_USER_SUCCESS","LOGIN_USER","LOGIN_USER_SUCCESS","LOGOUT_USER","REGISTER_USER","REGISTER_USER_SUCCESS","LOGIN_USER_ERROR","REGISTER_USER_ERROR","FORGOT_PASSWORD","FORGOT_PASSWORD_SUCCESS","FORGOT_PASSWORD_ERROR","RESET_PASSWORD","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_ERROR","loadUser","user","history","dispatch","getState","type","payload","get","headers","token","then","response","status","data","push","errorCode","catch","error","loginUser","post","email","password","localStorage","setItem","forgotPassword","forgotUserMail","forgotPasswordSuccess","forgotPasswordError","message","resetPassword","resetPasswordCode","newPassword","resetPasswordSuccess","resetPasswordError","registerUser","registerUserSuccess","registerUserError","logoutUser","displatch","removeItem"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport {servicePath, tokenPrefix} from \"../../constants/defaultValues\";\r\nimport errorMessage from \"../../constants/errorMessages\";\r\n\r\nimport {\r\n    LOAD_USER,\r\n    LOAD_USER_SUCCESS,\r\n    LOGIN_USER,\r\n    LOGIN_USER_SUCCESS,\r\n    LOGOUT_USER,\r\n    REGISTER_USER,\r\n    REGISTER_USER_SUCCESS,\r\n    LOGIN_USER_ERROR,\r\n    REGISTER_USER_ERROR,\r\n    FORGOT_PASSWORD,\r\n    FORGOT_PASSWORD_SUCCESS,\r\n    FORGOT_PASSWORD_ERROR,\r\n    RESET_PASSWORD,\r\n    RESET_PASSWORD_SUCCESS,\r\n    RESET_PASSWORD_ERROR\r\n} from '../actions';\r\n\r\nexport const loadUser = (user, history) => (dispatch, getState) => {\r\n\r\n    dispatch({\r\n        type: LOGIN_USER,\r\n        payload: { user, history }\r\n    });\r\n\r\n    axios.get(servicePath + \"/auth/user\", {\r\n        headers: {\r\n            'X-API-TOKEN': tokenPrefix + getState().token\r\n        }\r\n    }).then(response => {\r\n\r\n        if (response.status === 200 && response.data['message'] === \"\") {\r\n            const data = response.data['data'];\r\n            dispatch({\r\n                type: LOGIN_USER_SUCCESS,\r\n                payload: {\r\n                    token: data['api_token'],\r\n                    user: data['user']\r\n                }\r\n            });\r\n            history.push('/');\r\n        } else {\r\n            const errorCode = response.data['message'];\r\n            dispatch({\r\n                type: LOGIN_USER_ERROR,\r\n                payload: errorMessage[errorCode]\r\n            });\r\n        }\r\n\r\n    }).catch(error => {\r\n        dispatch({\r\n            type: LOGIN_USER_ERROR,\r\n            payload: error\r\n        });\r\n    });\r\n};\r\n\r\nexport const loginUser = (user, history) => dispatch => {\r\n\r\n    dispatch({\r\n        type: LOGIN_USER,\r\n        payload: { user, history }\r\n    });\r\n\r\n    axios.post(servicePath + \"/auth/login\", {\r\n        email: user.email,\r\n        password: user.password\r\n    }).then(response => {\r\n\r\n        if (response.status === 200 && response.data['message'] === \"\") {\r\n            const data = response.data['data'];\r\n            localStorage.setItem('_fs_utk', data['api_token']);\r\n            dispatch({\r\n                type: LOGIN_USER_SUCCESS,\r\n                payload: {\r\n                    token: data['api_token'],\r\n                    user: data['user']\r\n                }\r\n            });\r\n            history.push('/');\r\n        } else {\r\n            const errorCode = response.data['message'];\r\n            dispatch({\r\n                type: LOGIN_USER_ERROR,\r\n                payload: errorMessage[errorCode]\r\n            });\r\n        }\r\n\r\n    }).catch(error => {\r\n        dispatch({\r\n            type: LOGIN_USER_ERROR,\r\n            payload: error\r\n        });\r\n    });\r\n};\r\n\r\nexport const forgotPassword = (forgotUserMail, history) => ({\r\n    type: FORGOT_PASSWORD,\r\n    payload: {forgotUserMail, history}\r\n});\r\nexport const forgotPasswordSuccess = (forgotUserMail) => ({\r\n    type: FORGOT_PASSWORD_SUCCESS,\r\n    payload: forgotUserMail\r\n});\r\nexport const forgotPasswordError = (message) => ({\r\n    type: FORGOT_PASSWORD_ERROR,\r\n    payload: {message}\r\n});\r\n\r\nexport const resetPassword = ({resetPasswordCode, newPassword, history}) => ({\r\n    type: RESET_PASSWORD,\r\n    payload: {resetPasswordCode, newPassword, history}\r\n});\r\nexport const resetPasswordSuccess = (newPassword) => ({\r\n    type: RESET_PASSWORD_SUCCESS,\r\n    payload: newPassword\r\n});\r\nexport const resetPasswordError = (message) => ({\r\n    type: RESET_PASSWORD_ERROR,\r\n    payload: {message}\r\n});\r\n\r\n\r\nexport const registerUser = (user, history) => ({\r\n    type: REGISTER_USER,\r\n    payload: {user, history}\r\n})\r\nexport const registerUserSuccess = (user) => ({\r\n    type: REGISTER_USER_SUCCESS,\r\n    payload: user\r\n})\r\nexport const registerUserError = (message) => ({\r\n    type: REGISTER_USER_ERROR,\r\n    payload: {message}\r\n})\r\n\r\nexport const logoutUser = (history) => displatch => {\r\n    localStorage.removeItem('_fs_utk');\r\n    displatch({\r\n        type: LOGOUT_USER\r\n    });\r\n};"]},"metadata":{},"sourceType":"module"}