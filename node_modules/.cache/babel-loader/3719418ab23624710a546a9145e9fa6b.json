{"ast":null,"code":"import _toConsumableArray from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import{Row}from\"reactstrap\";import axios from\"axios\";import{servicePath,tokenPrefix}from\"../../../constants/defaultValues\";import Pagination from\"../../../containers/products/Pagination\";import ContextMenuContainer from\"../../../containers/products/ContextMenuContainer\";import ListPageHeading from\"../../../containers/products/ListPageHeading\";import AddNewModal from\"../../../containers/categories/AddNewModal\";import DataListView from\"../../../containers/categories/CategoryListView\";import{connect}from\"react-redux\";function collect(props){return{data:props.data};}var apiUrl=servicePath+\"/categories/paging\";var CategoryListPages=/*#__PURE__*/function(_Component){_inherits(CategoryListPages,_Component);var _super=_createSuper(CategoryListPages);function CategoryListPages(props){var _this;_classCallCheck(this,CategoryListPages);_this=_super.call(this,props);_this.toggleModal=function(){_this.setState({modalOpen:!_this.state.modalOpen});};_this.changeOrderBy=function(column){_this.setState({selectedOrderOption:_this.state.orderOptions.find(function(x){return x.column===column;})},function(){return _this.dataListRender();});};_this.changePageSize=function(size){_this.setState({selectedPageSize:size,currentPage:1},function(){return _this.dataListRender();});};_this.onChangePage=function(page){_this.setState({currentPage:page},function(){return _this.dataListRender();});};_this.onSearchKey=function(e){if(e.key===\"Enter\"){_this.setState({search:e.target.value.toLowerCase()},function(){return _this.dataListRender();});}};_this.onCheckItem=function(event,id){if(event.target.tagName===\"A\"||event.target.parentElement&&event.target.parentElement.tagName===\"A\"){return true;}if(_this.state.lastChecked===null){_this.setState({lastChecked:id});}var selectedItems=_this.state.selectedItems;if(selectedItems.includes(id)){selectedItems=selectedItems.filter(function(x){return x!==id;});}else{selectedItems.push(id);}_this.setState({selectedItems});if(event.shiftKey){var _selectedItems;var items=_this.state.items;var start=_this.getIndex(id,items,\"id\");var end=_this.getIndex(_this.state.lastChecked,items,\"id\");items=items.slice(Math.min(start,end),Math.max(start,end)+1);(_selectedItems=selectedItems).push.apply(_selectedItems,_toConsumableArray(items.map(function(item){return item.id;})));selectedItems=Array.from(new Set(selectedItems));_this.setState({selectedItems});}document.activeElement.blur();};_this.handleChangeSelectAll=function(isToggle){if(_this.state.selectedItems.length>=_this.state.items.length){if(isToggle){_this.setState({selectedItems:[]});}}else{_this.setState({selectedItems:_this.state.items.map(function(x){return x.id;})});}document.activeElement.blur();return false;};_this.onContextMenuClick=function(e,data,target){console.log(\"onContextMenuClick - selected items\",_this.state.selectedItems);console.log(\"onContextMenuClick - action : \",data.action);};_this.handleEditAction=function(){};_this.onContextMenu=function(e,data){var clickedProductId=data.data;if(!_this.state.selectedItems.includes(clickedProductId)){_this.setState({selectedItems:[clickedProductId]});}return true;};_this.mouseTrap=require('mousetrap');_this.state={displayMode:\"list\",selectedPageSize:8,orderOptions:[{column:\"\",label:\"Default\"},{column:\"name\",label:\"Name\"},{column:\"status\",label:\"Status\"}],pageSizes:[8,12,24],categories:[{label:\"Cakes\",value:\"Cakes\",key:0},{label:\"Cupcakes\",value:\"Cupcakes\",key:1},{label:\"Desserts\",value:\"Desserts\",key:2}],selectedOrderOption:{column:\"\",label:\"Default\"},dropdownSplitOpen:false,modalOpen:false,currentPage:1,totalItemCount:0,totalPage:1,search:\"\",selectedItems:[],lastChecked:null,isLoading:false};return _this;}_createClass(CategoryListPages,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.dataListRender();this.mouseTrap.bind([\"ctrl+a\",\"command+a\"],function(){return _this2.handleChangeSelectAll(false);});this.mouseTrap.bind([\"ctrl+d\",\"command+d\"],function(){_this2.setState({selectedItems:[]});return false;});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.mouseTrap.unbind(\"ctrl+a\");this.mouseTrap.unbind(\"command+a\");this.mouseTrap.unbind(\"ctrl+d\");this.mouseTrap.unbind(\"command+d\");}},{key:\"getIndex\",value:function getIndex(value,arr,prop){for(var i=0;i<arr.length;i++){if(arr[i][prop]===value){return i;}}return-1;}},{key:\"dataListRender\",value:function dataListRender(){var _this3=this;var _this$state=this.state,selectedPageSize=_this$state.selectedPageSize,currentPage=_this$state.currentPage,selectedOrderOption=_this$state.selectedOrderOption,search=_this$state.search;this.setState({isLoading:false});axios.get(\"\".concat(apiUrl,\"?pageSize=\").concat(selectedPageSize,\"&currentPage=\").concat(currentPage,\"&orderBy=\").concat(selectedOrderOption.column,\"&search=\").concat(search),{headers:{'X-API-TOKEN':tokenPrefix+this.props.apiToken}}).then(function(res){return res.data['data'];}).then(function(data){_this3.setState({totalPage:data.totalPage,items:data.data,selectedItems:[],totalItemCount:data.totalItem,isLoading:true});});}},{key:\"render\",value:function render(){var _this4=this;var _this$state2=this.state,currentPage=_this$state2.currentPage,items=_this$state2.items,selectedPageSize=_this$state2.selectedPageSize,totalItemCount=_this$state2.totalItemCount,selectedOrderOption=_this$state2.selectedOrderOption,selectedItems=_this$state2.selectedItems,orderOptions=_this$state2.orderOptions,pageSizes=_this$state2.pageSizes,modalOpen=_this$state2.modalOpen,categories=_this$state2.categories;var match=this.props.match;var startIndex=(currentPage-1)*selectedPageSize;var endIndex=currentPage*selectedPageSize;return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"disable-text-selection\"},/*#__PURE__*/React.createElement(ListPageHeading,{heading:\"menu.categories\",handleChangeSelectAll:this.handleChangeSelectAll,changeOrderBy:this.changeOrderBy,changePageSize:this.changePageSize,selectedPageSize:selectedPageSize,totalItemCount:totalItemCount,selectedOrderOption:selectedOrderOption,match:match,startIndex:startIndex,endIndex:endIndex,selectedItems:selectedItems,itemsLength:items?items.length:0,onSearchKey:this.onSearchKey,orderOptions:orderOptions,pageSizes:pageSizes,toggleModal:this.toggleModal,handleEditAction:this.handleEditAction}),/*#__PURE__*/React.createElement(AddNewModal,{modalOpen:modalOpen,dataListRender:this.dataListRender.bind(this),toggleModal:this.toggleModal,categories:categories}),!this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"}):/*#__PURE__*/React.createElement(Row,null,items.map(function(product){return/*#__PURE__*/React.createElement(DataListView,{key:product.id,product:product,isSelect:_this4.state.selectedItems.includes(product.id),onCheckItem:_this4.onCheckItem,collect:collect});}),\" \",/*#__PURE__*/React.createElement(Pagination,{currentPage:this.state.currentPage,totalPage:this.state.totalPage,onChangePage:function onChangePage(i){return _this4.onChangePage(i);}}),/*#__PURE__*/React.createElement(ContextMenuContainer,{onContextMenuClick:this.onContextMenuClick,onContextMenu:this.onContextMenu,selectedItemsLength:selectedItems?selectedItems.length:0}))));}}]);return CategoryListPages;}(Component);var mapStateToProps=function mapStateToProps(_ref){var authUser=_ref.authUser;var apiToken=authUser.token;return{apiToken};};export default connect(mapStateToProps,{})(CategoryListPages);","map":{"version":3,"sources":["/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/src/views/products/categories/list.js"],"names":["React","Component","Fragment","Row","axios","servicePath","tokenPrefix","Pagination","ContextMenuContainer","ListPageHeading","AddNewModal","DataListView","connect","collect","props","data","apiUrl","CategoryListPages","toggleModal","setState","modalOpen","state","changeOrderBy","column","selectedOrderOption","orderOptions","find","x","dataListRender","changePageSize","size","selectedPageSize","currentPage","onChangePage","page","onSearchKey","e","key","search","target","value","toLowerCase","onCheckItem","event","id","tagName","parentElement","lastChecked","selectedItems","includes","filter","push","shiftKey","items","start","getIndex","end","slice","Math","min","max","map","item","Array","from","Set","document","activeElement","blur","handleChangeSelectAll","isToggle","length","onContextMenuClick","console","log","action","handleEditAction","onContextMenu","clickedProductId","mouseTrap","require","displayMode","label","pageSizes","categories","dropdownSplitOpen","totalItemCount","totalPage","isLoading","bind","unbind","arr","prop","i","get","headers","apiToken","then","res","totalItem","match","startIndex","endIndex","product","mapStateToProps","authUser","token"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport { Row } from \"reactstrap\";\r\nimport axios from \"axios\";\r\n\r\nimport { servicePath, tokenPrefix } from \"../../../constants/defaultValues\";\r\n\r\nimport Pagination from \"../../../containers/products/Pagination\";\r\nimport ContextMenuContainer from \"../../../containers/products/ContextMenuContainer\";\r\nimport ListPageHeading from \"../../../containers/products/ListPageHeading\";\r\nimport AddNewModal from \"../../../containers/categories/AddNewModal\";\r\nimport DataListView from \"../../../containers/categories/CategoryListView\";\r\nimport {connect} from \"react-redux\";\r\n\r\nfunction collect(props) {\r\n    return { data: props.data };\r\n}\r\nconst apiUrl = servicePath + \"/categories/paging\";\r\n\r\nclass CategoryListPages extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.mouseTrap = require('mousetrap');\r\n        this.state = {\r\n            displayMode: \"list\",\r\n\r\n            selectedPageSize: 8,\r\n            orderOptions: [\r\n                { column: \"\", label: \"Default\" },\r\n                { column: \"name\", label: \"Name\" },\r\n                { column: \"status\", label: \"Status\" }\r\n            ],\r\n            pageSizes: [8, 12, 24],\r\n\r\n            categories: [\r\n                { label: \"Cakes\", value: \"Cakes\", key: 0 },\r\n                { label: \"Cupcakes\", value: \"Cupcakes\", key: 1 },\r\n                { label: \"Desserts\", value: \"Desserts\", key: 2 }\r\n            ],\r\n\r\n            selectedOrderOption: { column: \"\", label: \"Default\" },\r\n            dropdownSplitOpen: false,\r\n            modalOpen: false,\r\n            currentPage: 1,\r\n            totalItemCount: 0,\r\n            totalPage: 1,\r\n            search: \"\",\r\n            selectedItems: [],\r\n            lastChecked: null,\r\n            isLoading: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.dataListRender();\r\n        this.mouseTrap.bind([\"ctrl+a\", \"command+a\"], () =>\r\n            this.handleChangeSelectAll(false)\r\n        );\r\n        this.mouseTrap.bind([\"ctrl+d\", \"command+d\"], () => {\r\n            this.setState({\r\n                selectedItems: []\r\n            });\r\n            return false;\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mouseTrap.unbind(\"ctrl+a\");\r\n        this.mouseTrap.unbind(\"command+a\");\r\n        this.mouseTrap.unbind(\"ctrl+d\");\r\n        this.mouseTrap.unbind(\"command+d\");\r\n    }\r\n\r\n    toggleModal = () => {\r\n        this.setState({\r\n            modalOpen: !this.state.modalOpen\r\n        });\r\n    };\r\n\r\n    changeOrderBy = column => {\r\n        this.setState(\r\n            {\r\n                selectedOrderOption: this.state.orderOptions.find(\r\n                    x => x.column === column\r\n                )\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n    changePageSize = size => {\r\n        this.setState(\r\n            {\r\n                selectedPageSize: size,\r\n                currentPage: 1\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n\r\n    onChangePage = page => {\r\n        this.setState(\r\n            {\r\n                currentPage: page\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n\r\n    onSearchKey = e => {\r\n        if (e.key === \"Enter\") {\r\n            this.setState(\r\n                {\r\n                    search: e.target.value.toLowerCase()\r\n                },\r\n                () => this.dataListRender()\r\n            );\r\n        }\r\n    };\r\n\r\n    onCheckItem = (event, id) => {\r\n        if (\r\n            event.target.tagName === \"A\" ||\r\n            (event.target.parentElement && event.target.parentElement.tagName === \"A\")\r\n        ) {\r\n            return true;\r\n        }\r\n        if (this.state.lastChecked === null) {\r\n            this.setState({\r\n                lastChecked: id\r\n            });\r\n        }\r\n\r\n        let selectedItems = this.state.selectedItems;\r\n        if (selectedItems.includes(id)) {\r\n            selectedItems = selectedItems.filter(x => x !== id);\r\n        } else {\r\n            selectedItems.push(id);\r\n        }\r\n        this.setState({\r\n            selectedItems\r\n        });\r\n\r\n        if (event.shiftKey) {\r\n            var items = this.state.items;\r\n            var start = this.getIndex(id, items, \"id\");\r\n            var end = this.getIndex(this.state.lastChecked, items, \"id\");\r\n            items = items.slice(Math.min(start, end), Math.max(start, end) + 1);\r\n            selectedItems.push(\r\n                ...items.map(item => {\r\n                    return item.id;\r\n                })\r\n            );\r\n            selectedItems = Array.from(new Set(selectedItems));\r\n            this.setState({\r\n                selectedItems\r\n            });\r\n        }\r\n        document.activeElement.blur();\r\n    };\r\n\r\n    getIndex(value, arr, prop) {\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i][prop] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    handleChangeSelectAll = isToggle => {\r\n        if (this.state.selectedItems.length >= this.state.items.length) {\r\n            if (isToggle) {\r\n                this.setState({\r\n                    selectedItems: []\r\n                });\r\n            }\r\n        } else {\r\n            this.setState({\r\n                selectedItems: this.state.items.map(x => x.id)\r\n            });\r\n        }\r\n        document.activeElement.blur();\r\n        return false;\r\n    };\r\n\r\n\r\n    dataListRender() {\r\n        const {\r\n            selectedPageSize,\r\n            currentPage,\r\n            selectedOrderOption,\r\n            search\r\n        } = this.state;\r\n\r\n        this.setState({\r\n            isLoading: false\r\n        });\r\n\r\n        axios\r\n            .get(\r\n                `${apiUrl}?pageSize=${selectedPageSize}&currentPage=${currentPage}&orderBy=${\r\n                    selectedOrderOption.column\r\n                }&search=${search}`, {\r\n                    headers: {\r\n                        'X-API-TOKEN': tokenPrefix + this.props.apiToken\r\n                    }\r\n                }\r\n            )\r\n            .then(res => {\r\n                return res.data['data'];\r\n            })\r\n            .then(data => {\r\n                this.setState({\r\n                    totalPage: data.totalPage,\r\n                    items: data.data,\r\n                    selectedItems: [],\r\n                    totalItemCount: data.totalItem,\r\n                    isLoading: true\r\n                });\r\n            });\r\n    }\r\n\r\n    onContextMenuClick = (e, data, target) => {\r\n        console.log(\r\n            \"onContextMenuClick - selected items\",\r\n            this.state.selectedItems\r\n        );\r\n        console.log(\"onContextMenuClick - action : \", data.action);\r\n    };\r\n\r\n    handleEditAction = () => {\r\n\r\n    }\r\n\r\n    onContextMenu = (e, data) => {\r\n        const clickedProductId = data.data;\r\n        if (!this.state.selectedItems.includes(clickedProductId)) {\r\n            this.setState({\r\n                selectedItems: [clickedProductId]\r\n            });\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            currentPage,\r\n            items,\r\n            selectedPageSize,\r\n            totalItemCount,\r\n            selectedOrderOption,\r\n            selectedItems,\r\n            orderOptions,\r\n            pageSizes,\r\n            modalOpen,\r\n            categories\r\n        } = this.state;\r\n        const { match } = this.props;\r\n        const startIndex = (currentPage - 1) * selectedPageSize;\r\n        const endIndex = currentPage * selectedPageSize;\r\n\r\n        return (\r\n            <Fragment>\r\n                <div className=\"disable-text-selection\">\r\n                    <ListPageHeading\r\n                        heading=\"menu.categories\"\r\n                        handleChangeSelectAll={this.handleChangeSelectAll}\r\n                        changeOrderBy={this.changeOrderBy}\r\n                        changePageSize={this.changePageSize}\r\n                        selectedPageSize={selectedPageSize}\r\n                        totalItemCount={totalItemCount}\r\n                        selectedOrderOption={selectedOrderOption}\r\n                        match={match}\r\n                        startIndex={startIndex}\r\n                        endIndex={endIndex}\r\n                        selectedItems={selectedItems}\r\n                        itemsLength={items ? items.length : 0}\r\n                        onSearchKey={this.onSearchKey}\r\n                        orderOptions={orderOptions}\r\n                        pageSizes={pageSizes}\r\n                        toggleModal={this.toggleModal}\r\n                        handleEditAction={this.handleEditAction}\r\n                    />\r\n                    <AddNewModal\r\n                        modalOpen={modalOpen}\r\n                        dataListRender={this.dataListRender.bind(this)}\r\n                        toggleModal={this.toggleModal}\r\n                        categories={categories}\r\n                    />\r\n                    {\r\n                        !this.state.isLoading ? (\r\n                            <div className=\"loading\"/>\r\n                        ) :\r\n                        <Row>\r\n                            {items.map(product => {\r\n\r\n                                return (\r\n                                    <DataListView\r\n                                        key={product.id}\r\n                                        product={product}\r\n                                        isSelect={this.state.selectedItems.includes(product.id)}\r\n                                        onCheckItem={this.onCheckItem}\r\n                                        collect={collect}\r\n                                    />\r\n                                );\r\n\r\n                            })}{\" \"}\r\n                            <Pagination\r\n                                currentPage={this.state.currentPage}\r\n                                totalPage={this.state.totalPage}\r\n                                onChangePage={i => this.onChangePage(i)}\r\n                            />\r\n                            <ContextMenuContainer\r\n                                onContextMenuClick={this.onContextMenuClick}\r\n                                onContextMenu={this.onContextMenu}\r\n                                selectedItemsLength={selectedItems ? selectedItems.length : 0}\r\n                            />\r\n                        </Row>\r\n                    }\r\n                </div>\r\n            </Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({ authUser }) => {\r\n    const { token: apiToken } = authUser;\r\n    return { apiToken };\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    {}\r\n)(CategoryListPages);\r\n\r\n"]},"metadata":{},"sourceType":"module"}