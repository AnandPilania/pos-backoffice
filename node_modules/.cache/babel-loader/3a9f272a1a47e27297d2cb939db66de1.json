{"ast":null,"code":"import _toConsumableArray from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import{Row}from\"reactstrap\";import axios from\"axios\";import{servicePath,tokenPrefix}from\"../../../constants/defaultValues\";import Pagination from\"../../../containers/products/Pagination\";import ContextMenuContainer from\"../../../containers/products/ContextMenuContainer\";import ListPageHeading from\"../../../containers/products/ListPageHeading\";import ThumbListView from\"../../../containers/products/ThumbListView\";import AddNewModal from\"../../../containers/products/AddNewModal\";import ImageListView from\"../../../containers/products/ImageListView\";import DataListView from\"../../../containers/products/DataListView\";import{connect}from\"react-redux\";function collect(props){return{data:props.data};}var apiUrl=servicePath+\"/products/paging\";var ProductListPages=/*#__PURE__*/function(_Component){_inherits(ProductListPages,_Component);var _super=_createSuper(ProductListPages);function ProductListPages(props){var _this;_classCallCheck(this,ProductListPages);_this=_super.call(this,props);_this.toggleModal=function(){_this.setState({modalOpen:!_this.state.modalOpen});};_this.changeOrderBy=function(column){_this.setState({selectedOrderOption:_this.state.orderOptions.find(function(x){return x.column===column;})},function(){return _this.dataListRender();});};_this.changePageSize=function(size){_this.setState({selectedPageSize:size,currentPage:1},function(){return _this.dataListRender();});};_this.changeDisplayMode=function(mode){_this.setState({displayMode:mode});return false;};_this.onChangePage=function(page){_this.setState({currentPage:page},function(){return _this.dataListRender();});};_this.onSearchKey=function(e){if(e.key===\"Enter\"){_this.setState({search:e.target.value.toLowerCase()},function(){return _this.dataListRender();});}};_this.onCheckItem=function(event,id){if(event.target.tagName===\"A\"||event.target.parentElement&&event.target.parentElement.tagName===\"A\"){return true;}if(_this.state.lastChecked===null){_this.setState({lastChecked:id});}var selectedItems=_this.state.selectedItems;if(selectedItems.includes(id)){selectedItems=selectedItems.filter(function(x){return x!==id;});}else{selectedItems.push(id);}_this.setState({selectedItems});if(event.shiftKey){var _selectedItems;var items=_this.state.items;var start=_this.getIndex(id,items,\"id\");var end=_this.getIndex(_this.state.lastChecked,items,\"id\");items=items.slice(Math.min(start,end),Math.max(start,end)+1);(_selectedItems=selectedItems).push.apply(_selectedItems,_toConsumableArray(items.map(function(item){return item.id;})));selectedItems=Array.from(new Set(selectedItems));_this.setState({selectedItems});}document.activeElement.blur();};_this.handleChangeSelectAll=function(isToggle){if(_this.state.selectedItems.length>=_this.state.items.length){if(isToggle){_this.setState({selectedItems:[]});}}else{_this.setState({selectedItems:_this.state.items.map(function(x){return x.id;})});}document.activeElement.blur();return false;};_this.getCategoryList=function(){axios.get(\"\".concat(servicePath,\"/categories/all\"),{headers:{'X-API-TOKEN':tokenPrefix+_this.props.apiToken}}).then(function(res){return res.data['data'];}).then(function(data){_this.setState({categories:data['category_list']});});};_this.onContextMenuClick=function(e,data,target){console.log(\"onContextMenuClick - selected items\",_this.state.selectedItems);console.log(\"onContextMenuClick - action : \",data.action);if(data.action==='edit'){_this.props.history.push(_this.props.match.url+'/edit/'+_this.state.selectedItems[0]);}};_this.onContextMenu=function(e,data){var clickedProductId=data.data;if(!_this.state.selectedItems.includes(clickedProductId)){_this.setState({selectedItems:[clickedProductId]});}return true;};_this.mouseTrap=require('mousetrap');_this.state={displayMode:\"thumblist\",selectedPageSize:8,orderOptions:[{column:\"\",label:\"Default\"},{column:\"name\",label:\"Product Name\"},{column:\"category\",label:\"Category\"},{column:\"status\",label:\"Status\"}],pageSizes:[8,12,24],categories:[],selectedOrderOption:{column:\"\",label:\"Default\"},dropdownSplitOpen:false,modalOpen:false,currentPage:1,totalItemCount:0,totalPage:1,search:\"\",selectedItems:[],lastChecked:null,isLoading:false};return _this;}_createClass(ProductListPages,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.dataListRender();this.getCategoryList();this.mouseTrap.bind([\"ctrl+a\",\"command+a\"],function(){return _this2.handleChangeSelectAll(false);});this.mouseTrap.bind([\"ctrl+d\",\"command+d\"],function(){_this2.setState({selectedItems:[]});return false;});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.mouseTrap.unbind(\"ctrl+a\");this.mouseTrap.unbind(\"command+a\");this.mouseTrap.unbind(\"ctrl+d\");this.mouseTrap.unbind(\"command+d\");}},{key:\"getIndex\",value:function getIndex(value,arr,prop){for(var i=0;i<arr.length;i++){if(arr[i][prop]===value){return i;}}return-1;}},{key:\"dataListRender\",value:function dataListRender(){var _this3=this;var _this$state=this.state,selectedPageSize=_this$state.selectedPageSize,currentPage=_this$state.currentPage,selectedOrderOption=_this$state.selectedOrderOption,search=_this$state.search;this.setState({isLoading:false});axios.get(\"\".concat(apiUrl,\"?pageSize=\").concat(selectedPageSize,\"&currentPage=\").concat(currentPage,\"&orderBy=\").concat(selectedOrderOption.column,\"&search=\").concat(search),{headers:{'X-API-TOKEN':tokenPrefix+this.props.apiToken}}).then(function(res){return res.data['data'];}).then(function(data){_this3.setState({totalPage:data.totalPage,items:data.data,selectedItems:[],totalItemCount:data.totalItem,isLoading:true});});}},{key:\"render\",value:function render(){var _this4=this;var _this$state2=this.state,currentPage=_this$state2.currentPage,items=_this$state2.items,displayMode=_this$state2.displayMode,selectedPageSize=_this$state2.selectedPageSize,totalItemCount=_this$state2.totalItemCount,selectedOrderOption=_this$state2.selectedOrderOption,selectedItems=_this$state2.selectedItems,orderOptions=_this$state2.orderOptions,pageSizes=_this$state2.pageSizes,modalOpen=_this$state2.modalOpen,categories=_this$state2.categories;var match=this.props.match;var startIndex=(currentPage-1)*selectedPageSize;var endIndex=currentPage*selectedPageSize;return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"disable-text-selection\"},/*#__PURE__*/React.createElement(ListPageHeading,{heading:\"menu.products\",displayModeEnable:1,displayMode:displayMode,changeDisplayMode:this.changeDisplayMode,handleChangeSelectAll:this.handleChangeSelectAll,changeOrderBy:this.changeOrderBy,changePageSize:this.changePageSize,selectedPageSize:selectedPageSize,totalItemCount:totalItemCount,selectedOrderOption:selectedOrderOption,match:match,startIndex:startIndex,endIndex:endIndex,selectedItemsLength:selectedItems?selectedItems.length:0,itemsLength:items?items.length:0,onSearchKey:this.onSearchKey,orderOptions:orderOptions,pageSizes:pageSizes,toggleModal:this.toggleModal}),/*#__PURE__*/React.createElement(AddNewModal,{modalOpen:modalOpen,categories:categories,history:this.props.history,match:this.props.match}),!this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"}):/*#__PURE__*/React.createElement(Row,null,this.state.items.map(function(product){if(_this4.state.displayMode===\"imagelist\"){return/*#__PURE__*/React.createElement(ImageListView,{key:product.id,product:product,isSelect:_this4.state.selectedItems.includes(product.id),collect:collect,onCheckItem:_this4.onCheckItem});}else if(_this4.state.displayMode===\"thumblist\"){return/*#__PURE__*/React.createElement(ThumbListView,{key:product.id,product:product,isSelect:_this4.state.selectedItems.includes(product.id),collect:collect,onCheckItem:_this4.onCheckItem});}else{return/*#__PURE__*/React.createElement(DataListView,{key:product.id,product:product,isSelect:_this4.state.selectedItems.includes(product.id),onCheckItem:_this4.onCheckItem,collect:collect});}}),\" \",/*#__PURE__*/React.createElement(Pagination,{currentPage:this.state.currentPage,totalPage:this.state.totalPage,onChangePage:function onChangePage(i){return _this4.onChangePage(i);}}),/*#__PURE__*/React.createElement(ContextMenuContainer,{onContextMenuClick:this.onContextMenuClick,onContextMenu:this.onContextMenu,selectedItemsLength:selectedItems?selectedItems.length:0}))));}}]);return ProductListPages;}(Component);var mapStateToProps=function mapStateToProps(_ref){var authUser=_ref.authUser;var apiToken=authUser.token;return{apiToken};};export default connect(mapStateToProps,{})(ProductListPages);","map":{"version":3,"sources":["/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/src/views/products/products/list.js"],"names":["React","Component","Fragment","Row","axios","servicePath","tokenPrefix","Pagination","ContextMenuContainer","ListPageHeading","ThumbListView","AddNewModal","ImageListView","DataListView","connect","collect","props","data","apiUrl","ProductListPages","toggleModal","setState","modalOpen","state","changeOrderBy","column","selectedOrderOption","orderOptions","find","x","dataListRender","changePageSize","size","selectedPageSize","currentPage","changeDisplayMode","mode","displayMode","onChangePage","page","onSearchKey","e","key","search","target","value","toLowerCase","onCheckItem","event","id","tagName","parentElement","lastChecked","selectedItems","includes","filter","push","shiftKey","items","start","getIndex","end","slice","Math","min","max","map","item","Array","from","Set","document","activeElement","blur","handleChangeSelectAll","isToggle","length","getCategoryList","get","headers","apiToken","then","res","categories","onContextMenuClick","console","log","action","history","match","url","onContextMenu","clickedProductId","mouseTrap","require","label","pageSizes","dropdownSplitOpen","totalItemCount","totalPage","isLoading","bind","unbind","arr","prop","i","totalItem","startIndex","endIndex","product","mapStateToProps","authUser","token"],"mappings":"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","sourcesContent":["import React, {Component, Fragment} from \"react\";\r\nimport {Row} from \"reactstrap\";\r\nimport axios from \"axios\";\r\n\r\nimport {servicePath, tokenPrefix} from \"../../../constants/defaultValues\";\r\n\r\nimport Pagination from \"../../../containers/products/Pagination\";\r\nimport ContextMenuContainer from \"../../../containers/products/ContextMenuContainer\";\r\nimport ListPageHeading from \"../../../containers/products/ListPageHeading\";\r\nimport ThumbListView from \"../../../containers/products/ThumbListView\";\r\nimport AddNewModal from \"../../../containers/products/AddNewModal\";\r\nimport ImageListView from \"../../../containers/products/ImageListView\";\r\nimport DataListView from \"../../../containers/products/DataListView\";\r\nimport {connect} from \"react-redux\";\r\n\r\nfunction collect(props) {\r\n    return {data: props.data};\r\n}\r\n\r\nconst apiUrl = servicePath + \"/products/paging\";\r\n\r\nclass ProductListPages extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.mouseTrap = require('mousetrap');\r\n        this.state = {\r\n            displayMode: \"thumblist\",\r\n\r\n            selectedPageSize: 8,\r\n            orderOptions: [\r\n                {column: \"\", label: \"Default\"},\r\n                {column: \"name\", label: \"Product Name\"},\r\n                {column: \"category\", label: \"Category\"},\r\n                {column: \"status\", label: \"Status\"}\r\n            ],\r\n            pageSizes: [8, 12, 24],\r\n\r\n            categories: [],\r\n\r\n            selectedOrderOption: {column: \"\", label: \"Default\"},\r\n            dropdownSplitOpen: false,\r\n            modalOpen: false,\r\n            currentPage: 1,\r\n            totalItemCount: 0,\r\n            totalPage: 1,\r\n            search: \"\",\r\n            selectedItems: [],\r\n            lastChecked: null,\r\n            isLoading: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.dataListRender();\r\n        this.getCategoryList();\r\n        this.mouseTrap.bind([\"ctrl+a\", \"command+a\"], () =>\r\n            this.handleChangeSelectAll(false)\r\n        );\r\n        this.mouseTrap.bind([\"ctrl+d\", \"command+d\"], () => {\r\n            this.setState({\r\n                selectedItems: []\r\n            });\r\n            return false;\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mouseTrap.unbind(\"ctrl+a\");\r\n        this.mouseTrap.unbind(\"command+a\");\r\n        this.mouseTrap.unbind(\"ctrl+d\");\r\n        this.mouseTrap.unbind(\"command+d\");\r\n    }\r\n\r\n    toggleModal = () => {\r\n        this.setState({\r\n            modalOpen: !this.state.modalOpen\r\n        });\r\n    };\r\n\r\n    changeOrderBy = column => {\r\n        this.setState(\r\n            {\r\n                selectedOrderOption: this.state.orderOptions.find(\r\n                    x => x.column === column\r\n                )\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n    changePageSize = size => {\r\n        this.setState(\r\n            {\r\n                selectedPageSize: size,\r\n                currentPage: 1\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n    changeDisplayMode = mode => {\r\n        this.setState({\r\n            displayMode: mode\r\n        });\r\n        return false;\r\n    };\r\n    onChangePage = page => {\r\n        this.setState(\r\n            {\r\n                currentPage: page\r\n            },\r\n            () => this.dataListRender()\r\n        );\r\n    };\r\n\r\n    onSearchKey = e => {\r\n        if (e.key === \"Enter\") {\r\n            this.setState(\r\n                {\r\n                    search: e.target.value.toLowerCase()\r\n                },\r\n                () => this.dataListRender()\r\n            );\r\n        }\r\n    };\r\n\r\n    onCheckItem = (event, id) => {\r\n        if (\r\n            event.target.tagName === \"A\" ||\r\n            (event.target.parentElement && event.target.parentElement.tagName === \"A\")\r\n        ) {\r\n            return true;\r\n        }\r\n        if (this.state.lastChecked === null) {\r\n            this.setState({\r\n                lastChecked: id\r\n            });\r\n        }\r\n\r\n        let selectedItems = this.state.selectedItems;\r\n        if (selectedItems.includes(id)) {\r\n            selectedItems = selectedItems.filter(x => x !== id);\r\n        } else {\r\n            selectedItems.push(id);\r\n        }\r\n        this.setState({\r\n            selectedItems\r\n        });\r\n\r\n        if (event.shiftKey) {\r\n            var items = this.state.items;\r\n            var start = this.getIndex(id, items, \"id\");\r\n            var end = this.getIndex(this.state.lastChecked, items, \"id\");\r\n            items = items.slice(Math.min(start, end), Math.max(start, end) + 1);\r\n            selectedItems.push(\r\n                ...items.map(item => {\r\n                    return item.id;\r\n                })\r\n            );\r\n            selectedItems = Array.from(new Set(selectedItems));\r\n            this.setState({\r\n                selectedItems\r\n            });\r\n        }\r\n        document.activeElement.blur();\r\n    };\r\n\r\n    getIndex(value, arr, prop) {\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (arr[i][prop] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    handleChangeSelectAll = isToggle => {\r\n        if (this.state.selectedItems.length >= this.state.items.length) {\r\n            if (isToggle) {\r\n                this.setState({\r\n                    selectedItems: []\r\n                });\r\n            }\r\n        } else {\r\n            this.setState({\r\n                selectedItems: this.state.items.map(x => x.id)\r\n            });\r\n        }\r\n        document.activeElement.blur();\r\n        return false;\r\n    };\r\n\r\n\r\n    dataListRender() {\r\n        const {\r\n            selectedPageSize,\r\n            currentPage,\r\n            selectedOrderOption,\r\n            search\r\n        } = this.state;\r\n\r\n        this.setState({\r\n            isLoading: false\r\n        });\r\n\r\n        axios\r\n            .get(\r\n                `${apiUrl}?pageSize=${selectedPageSize}&currentPage=${currentPage}&orderBy=${\r\n                    selectedOrderOption.column\r\n                }&search=${search}`, {\r\n                    headers: {\r\n                        'X-API-TOKEN': tokenPrefix + this.props.apiToken\r\n                    }\r\n                }\r\n            )\r\n            .then(res => {\r\n                return res.data['data'];\r\n            })\r\n            .then(data => {\r\n                this.setState({\r\n                    totalPage: data.totalPage,\r\n                    items: data.data,\r\n                    selectedItems: [],\r\n                    totalItemCount: data.totalItem,\r\n                    isLoading: true\r\n                });\r\n            });\r\n    }\r\n\r\n    getCategoryList = () => {\r\n        axios\r\n            .get(\r\n                `${servicePath}/categories/all`, {\r\n                    headers: {\r\n                        'X-API-TOKEN': tokenPrefix + this.props.apiToken\r\n                    }\r\n                }\r\n            )\r\n            .then(res => {\r\n                return res.data['data'];\r\n            })\r\n            .then(data => {\r\n                this.setState({\r\n                    categories: data['category_list']\r\n                });\r\n            });\r\n    }\r\n\r\n    onContextMenuClick = (e, data, target) => {\r\n        console.log(\r\n            \"onContextMenuClick - selected items\",\r\n            this.state.selectedItems\r\n        );\r\n        console.log(\"onContextMenuClick - action : \", data.action);\r\n        if (data.action === 'edit') {\r\n            this.props.history.push(this.props.match.url + '/edit/' + this.state.selectedItems[0]);\r\n        }\r\n    };\r\n\r\n    onContextMenu = (e, data) => {\r\n        const clickedProductId = data.data;\r\n        if (!this.state.selectedItems.includes(clickedProductId)) {\r\n            this.setState({\r\n                selectedItems: [clickedProductId]\r\n            });\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            currentPage,\r\n            items,\r\n            displayMode,\r\n            selectedPageSize,\r\n            totalItemCount,\r\n            selectedOrderOption,\r\n            selectedItems,\r\n            orderOptions,\r\n            pageSizes,\r\n            modalOpen,\r\n            categories\r\n        } = this.state;\r\n        const {match} = this.props;\r\n        const startIndex = (currentPage - 1) * selectedPageSize;\r\n        const endIndex = currentPage * selectedPageSize;\r\n\r\n        return (\r\n            <Fragment>\r\n                <div className=\"disable-text-selection\">\r\n                    <ListPageHeading\r\n                        heading=\"menu.products\"\r\n                        displayModeEnable={1}\r\n                        displayMode={displayMode}\r\n                        changeDisplayMode={this.changeDisplayMode}\r\n                        handleChangeSelectAll={this.handleChangeSelectAll}\r\n                        changeOrderBy={this.changeOrderBy}\r\n                        changePageSize={this.changePageSize}\r\n                        selectedPageSize={selectedPageSize}\r\n                        totalItemCount={totalItemCount}\r\n                        selectedOrderOption={selectedOrderOption}\r\n                        match={match}\r\n                        startIndex={startIndex}\r\n                        endIndex={endIndex}\r\n                        selectedItemsLength={selectedItems ? selectedItems.length : 0}\r\n                        itemsLength={items ? items.length : 0}\r\n                        onSearchKey={this.onSearchKey}\r\n                        orderOptions={orderOptions}\r\n                        pageSizes={pageSizes}\r\n                        toggleModal={this.toggleModal}\r\n                    />\r\n                    <AddNewModal\r\n                        modalOpen={modalOpen}\r\n                        categories={categories}\r\n                        history={this.props.history}\r\n                        match={this.props.match}\r\n                    />\r\n                    {\r\n                        !this.state.isLoading ? (\r\n                                <div className=\"loading\"/>\r\n                            ) :\r\n                            <Row>\r\n                                {this.state.items.map(product => {\r\n                                    if (this.state.displayMode === \"imagelist\") {\r\n                                        return (\r\n                                            <ImageListView\r\n                                                key={product.id}\r\n                                                product={product}\r\n                                                isSelect={this.state.selectedItems.includes(product.id)}\r\n                                                collect={collect}\r\n                                                onCheckItem={this.onCheckItem}\r\n                                            />\r\n                                        );\r\n                                    } else if (this.state.displayMode === \"thumblist\") {\r\n                                        return (\r\n                                            <ThumbListView\r\n                                                key={product.id}\r\n                                                product={product}\r\n                                                isSelect={this.state.selectedItems.includes(product.id)}\r\n                                                collect={collect}\r\n                                                onCheckItem={this.onCheckItem}\r\n                                            />\r\n                                        );\r\n                                    } else {\r\n                                        return (\r\n                                            <DataListView\r\n                                                key={product.id}\r\n                                                product={product}\r\n                                                isSelect={this.state.selectedItems.includes(product.id)}\r\n                                                onCheckItem={this.onCheckItem}\r\n                                                collect={collect}\r\n                                            />\r\n                                        );\r\n                                    }\r\n                                })}{\" \"}\r\n                                <Pagination\r\n                                    currentPage={this.state.currentPage}\r\n                                    totalPage={this.state.totalPage}\r\n                                    onChangePage={i => this.onChangePage(i)}\r\n                                />\r\n                                <ContextMenuContainer\r\n                                    onContextMenuClick={this.onContextMenuClick}\r\n                                    onContextMenu={this.onContextMenu}\r\n                                    selectedItemsLength={selectedItems ? selectedItems.length : 0}\r\n                                />\r\n                            </Row>\r\n                    }\r\n                </div>\r\n            </Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({authUser}) => {\r\n    const {token: apiToken} = authUser;\r\n    return {apiToken};\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    {}\r\n)(ProductListPages);\r\n\r\n"]},"metadata":{},"sourceType":"module"}