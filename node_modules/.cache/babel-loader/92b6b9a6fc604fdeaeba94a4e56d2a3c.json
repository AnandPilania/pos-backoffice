{"ast":null,"code":"import axios from\"axios\";import{servicePath,tokenPrefix}from\"../../constants/defaultValues\";import errorMessage from\"../../constants/errorMessages\";import{LOAD_USER_SUCCESS,LOGIN_USER,LOGIN_USER_SUCCESS,LOGOUT_USER,REGISTER_USER,REGISTER_USER_SUCCESS,LOGIN_USER_ERROR,REGISTER_USER_ERROR,FORGOT_PASSWORD,FORGOT_PASSWORD_SUCCESS,FORGOT_PASSWORD_ERROR,RESET_PASSWORD,RESET_PASSWORD_SUCCESS,RESET_PASSWORD_ERROR}from'../actions';export var loadUser=function loadUser(user,history){return function(dispatch,getState){dispatch({type:LOGIN_USER,payload:{user,history}});axios.get(servicePath+\"/auth/user\",{headers:{'X-API-TOKEN':tokenPrefix+getState().token}}).then(function(response){if(response.status===200&&response.data['message']===\"\"){var data=response.data['data'];dispatch({type:LOAD_USER_SUCCESS,payload:data['user']});}else{logoutUser();}}).catch(function(error){logoutUser();});};};export var loginUser=function loginUser(user,history){return function(dispatch){dispatch({type:LOGIN_USER,payload:{user,history}});axios.post(servicePath+\"/auth/login\",{email:user.email,password:user.password}).then(function(response){if(response.status===200&&response.data['message']===\"\"){var data=response.data['data'];localStorage.setItem('_fs_utk',data['api_token']);localStorage.setItem('user_info',JSON.stringify(data['user']));dispatch({type:LOGIN_USER_SUCCESS,payload:{token:data['api_token'],user:data['user']}});history.push('/');}else{var errorCode=response.data['message'];dispatch({type:LOGIN_USER_ERROR,payload:errorMessage[errorCode]});}}).catch(function(error){dispatch({type:LOGIN_USER_ERROR,payload:error});});};};export var forgotPassword=function forgotPassword(forgotUserMail,history){return{type:FORGOT_PASSWORD,payload:{forgotUserMail,history}};};export var forgotPasswordSuccess=function forgotPasswordSuccess(forgotUserMail){return{type:FORGOT_PASSWORD_SUCCESS,payload:forgotUserMail};};export var forgotPasswordError=function forgotPasswordError(message){return{type:FORGOT_PASSWORD_ERROR,payload:{message}};};export var resetPassword=function resetPassword(_ref){var resetPasswordCode=_ref.resetPasswordCode,newPassword=_ref.newPassword,history=_ref.history;return{type:RESET_PASSWORD,payload:{resetPasswordCode,newPassword,history}};};export var resetPasswordSuccess=function resetPasswordSuccess(newPassword){return{type:RESET_PASSWORD_SUCCESS,payload:newPassword};};export var resetPasswordError=function resetPasswordError(message){return{type:RESET_PASSWORD_ERROR,payload:{message}};};export var registerUser=function registerUser(user,history){return{type:REGISTER_USER,payload:{user,history}};};export var registerUserSuccess=function registerUserSuccess(user){return{type:REGISTER_USER_SUCCESS,payload:user};};export var registerUserError=function registerUserError(message){return{type:REGISTER_USER_ERROR,payload:{message}};};export var logoutUser=function logoutUser(){return function(displatch){localStorage.removeItem('_fs_utk');localStorage.removeItem('user_info');displatch({type:LOGOUT_USER});};};","map":{"version":3,"sources":["/Volumes/DATA/project/20200412_POSbackoffice_django_react/project/POS-backoffice/frontend/src/redux/auth/actions.js"],"names":["axios","servicePath","tokenPrefix","errorMessage","LOAD_USER_SUCCESS","LOGIN_USER","LOGIN_USER_SUCCESS","LOGOUT_USER","REGISTER_USER","REGISTER_USER_SUCCESS","LOGIN_USER_ERROR","REGISTER_USER_ERROR","FORGOT_PASSWORD","FORGOT_PASSWORD_SUCCESS","FORGOT_PASSWORD_ERROR","RESET_PASSWORD","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_ERROR","loadUser","user","history","dispatch","getState","type","payload","get","headers","token","then","response","status","data","logoutUser","catch","error","loginUser","post","email","password","localStorage","setItem","JSON","stringify","push","errorCode","forgotPassword","forgotUserMail","forgotPasswordSuccess","forgotPasswordError","message","resetPassword","resetPasswordCode","newPassword","resetPasswordSuccess","resetPasswordError","registerUser","registerUserSuccess","registerUserError","displatch","removeItem"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport {servicePath, tokenPrefix} from \"../../constants/defaultValues\";\r\nimport errorMessage from \"../../constants/errorMessages\";\r\n\r\nimport {\r\n    LOAD_USER_SUCCESS,\r\n    LOGIN_USER,\r\n    LOGIN_USER_SUCCESS,\r\n    LOGOUT_USER,\r\n    REGISTER_USER,\r\n    REGISTER_USER_SUCCESS,\r\n    LOGIN_USER_ERROR,\r\n    REGISTER_USER_ERROR,\r\n    FORGOT_PASSWORD,\r\n    FORGOT_PASSWORD_SUCCESS,\r\n    FORGOT_PASSWORD_ERROR,\r\n    RESET_PASSWORD,\r\n    RESET_PASSWORD_SUCCESS,\r\n    RESET_PASSWORD_ERROR\r\n} from '../actions';\r\n\r\nexport const loadUser = (user, history) => (dispatch, getState) => {\r\n\r\n    dispatch({\r\n        type: LOGIN_USER,\r\n        payload: { user, history }\r\n    });\r\n\r\n    axios.get(servicePath + \"/auth/user\", {\r\n        headers: {\r\n            'X-API-TOKEN': tokenPrefix + getState().token\r\n        }\r\n    }).then(response => {\r\n\r\n        if (response.status === 200 && response.data['message'] === \"\") {\r\n            const data = response.data['data'];\r\n            dispatch({\r\n                type: LOAD_USER_SUCCESS,\r\n                payload:  data['user']\r\n            });\r\n        } else {\r\n            logoutUser();\r\n        }\r\n\r\n    }).catch(error => {\r\n        logoutUser();\r\n    });\r\n};\r\n\r\nexport const loginUser = (user, history) => dispatch => {\r\n\r\n    dispatch({\r\n        type: LOGIN_USER,\r\n        payload: { user, history }\r\n    });\r\n\r\n    axios.post(servicePath + \"/auth/login\", {\r\n        email: user.email,\r\n        password: user.password\r\n    }).then(response => {\r\n\r\n        if (response.status === 200 && response.data['message'] === \"\") {\r\n            const data = response.data['data'];\r\n            localStorage.setItem('_fs_utk', data['api_token']);\r\n            localStorage.setItem('user_info', JSON.stringify(data['user']));\r\n            dispatch({\r\n                type: LOGIN_USER_SUCCESS,\r\n                payload: {\r\n                    token: data['api_token'],\r\n                    user: data['user']\r\n                }\r\n            });\r\n            history.push('/');\r\n        } else {\r\n            const errorCode = response.data['message'];\r\n            dispatch({\r\n                type: LOGIN_USER_ERROR,\r\n                payload: errorMessage[errorCode]\r\n            });\r\n        }\r\n\r\n    }).catch(error => {\r\n        dispatch({\r\n            type: LOGIN_USER_ERROR,\r\n            payload: error\r\n        });\r\n    });\r\n};\r\n\r\nexport const forgotPassword = (forgotUserMail, history) => ({\r\n    type: FORGOT_PASSWORD,\r\n    payload: {forgotUserMail, history}\r\n});\r\nexport const forgotPasswordSuccess = (forgotUserMail) => ({\r\n    type: FORGOT_PASSWORD_SUCCESS,\r\n    payload: forgotUserMail\r\n});\r\nexport const forgotPasswordError = (message) => ({\r\n    type: FORGOT_PASSWORD_ERROR,\r\n    payload: {message}\r\n});\r\n\r\nexport const resetPassword = ({resetPasswordCode, newPassword, history}) => ({\r\n    type: RESET_PASSWORD,\r\n    payload: {resetPasswordCode, newPassword, history}\r\n});\r\nexport const resetPasswordSuccess = (newPassword) => ({\r\n    type: RESET_PASSWORD_SUCCESS,\r\n    payload: newPassword\r\n});\r\nexport const resetPasswordError = (message) => ({\r\n    type: RESET_PASSWORD_ERROR,\r\n    payload: {message}\r\n});\r\n\r\n\r\nexport const registerUser = (user, history) => ({\r\n    type: REGISTER_USER,\r\n    payload: {user, history}\r\n})\r\nexport const registerUserSuccess = (user) => ({\r\n    type: REGISTER_USER_SUCCESS,\r\n    payload: user\r\n})\r\nexport const registerUserError = (message) => ({\r\n    type: REGISTER_USER_ERROR,\r\n    payload: {message}\r\n})\r\n\r\nexport const logoutUser = () => displatch => {\r\n    localStorage.removeItem('_fs_utk');\r\n    localStorage.removeItem('user_info');\r\n    displatch({\r\n        type: LOGOUT_USER\r\n    });\r\n};"]},"metadata":{},"sourceType":"module"}